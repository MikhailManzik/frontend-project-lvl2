# Name of workflow
name: linter
# Trigger the workflow on push
on: push

jobs:
  linter:
    # The type of machine to run the job on
    runs-on: ubuntu-latest
    
    steps:
    # Check-out repository under GitHub workspace
    # https://github.com/actions/checkout
    - uses: actions/checkout@v2
    # Install and build project
    - name: npm install, build
      run: make install
    # run linter
    - name: run linter
      run: make lint
    - name: Test & publish code coverage
      # Publish code coverage on Code Climate
      # https://github.com/paambaati/codeclimate-action
      uses: paambaati/codeclimate-action@v2.7.5
      # Add Code Climate secret key
      env:
        CC_TEST_REPORTER_ID: ${{ secrets.CC_TEST_REPORTER_ID }}
      with:
        coverageCommand: make test-coverage
        debug: true